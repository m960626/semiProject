<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.example.mini.mapper.ClubMapper">
	<insert id="insertClub" parameterType="hashmap">
		INSERT INTO T2_CLUB
			(cLoc, cInfo, cName, cAge1, cAge2, cStat, cDay1, cDay2, cDay3, cMax, cGrade, cGender, cDate, id)
		VALUES
			(#{cLoc}, #{cont}, #{cName}, #{age1}, #{age2}, #{cStatus}, #{day1}, #{day2}, #{day3}, #{cMax}, #{cGrade}, #{cGender}, NOW(), 'test123')
	</insert>
	
	
	<!-- 클럽 상세보기(클럽 정보) -->
	<select id="selectClubinfo" parameterType="hashmap" resultType="com.example.mini.model.Club">
		SELECT *
		FROM T2_CLUB C
		INNER JOIN T2_USER U ON U.ID = C.CID
		INNER JOIN T2_LOC L ON C.CLOC = L.LOCNUM
		WHERE C.CNO = #{cNo}
	</select>
	
	
	<!-- 클럽 현재 인원 -->
	<select id="selectClubUserCnt" parameterType="hashmap" resultType="int">
		SELECT COUNT(*)
		FROM T2_USER U
		WHERE CNO = #{cNo}
	</select>
	
	<!-- 클럽 선수 명단 -->
	<select id="selectClubUserList" parameterType="hashmap" resultType="com.example.mini.model.Join">
		SELECT *
		FROM T2_USER U
		WHERE CNO = #{cNo}
	</select>
	
	
	<!-- 클럽 신청 내역 -->
	<select id="selectClubJoin" parameterType="hashmap" resultType="com.example.mini.model.Join">
		SELECT *
		FROM T2_CLUBJOIN J
		INNER JOIN T2_USER U ON J.ID = U.ID
		WHERE J.CNO = #{cNo} AND DELYN= 'N'
	</select>
	
	
	<!-- 클럽 신청 내역 거절 -->
	<update id="updateJoinFalse" parameterType="hashmap">
		UPDATE T2_CLUBJOIN
		SET jStat = '3'
		WHERE jNo = #{jNo}
	</update>
	
	<!-- 클럽 신청 내역 수락 시 타임라인 추가 -->
	<insert id="insertClubTL" parameterType="hashmap">
		INSERT INTO T2_CLUBTL
			(tDate, cNo, tKind, id)
		VALUES
			(NOW(), #{cNo}, '1', #{id})
	</insert>
	
	<!-- 클럽 신청 수락 시 클럽 멤버 추가 -->
	<update id="insertJoinTrue" parameterType="hashmap">
		UPDATE T2_USER
		SET cNo = #{cNo}
		WHERE id = #{id}
	</update>
	
	<!-- 클럽 신청 내역 거절 -->
	<update id="updateJoinTrue" parameterType="hashmap">
		UPDATE T2_CLUBJOIN
		SET jStat = '2'
		WHERE jNo = #{jNo}
	</update>
	
	<!-- 최근 경기 기록 -->
	<select id="selectMatchList" parameterType="hashmap" resultType="com.example.mini.model.Matching">
		SELECT * 
		FROM mini_db2.T2_MATCH
		WHERE CNO_H = #{cName} OR CNO_A = #{cName}
	</select>
	
	
	
	
	
	
	
	
	
</mapper>
